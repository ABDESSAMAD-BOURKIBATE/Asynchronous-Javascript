<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XP Gold - Promise.all() Exercises</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            background: linear-gradient(45deg, #f39c12, #e74c3c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2.5em;
            margin: 0;
        }
        
        .gold-badge {
            background: linear-gradient(45deg, #f1c40f, #f39c12);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            display: inline-block;
            margin-top: 10px;
        }
        
        h2 {
            color: #2c3e50;
            border-left: 5px solid #f39c12;
            padding-left: 15px;
            margin-top: 30px;
        }
        
        .exercise-section {
            margin: 25px 0;
            padding: 25px;
            border-left: 4px solid #f39c12;
            background: linear-gradient(135deg, #fef9e7 0%, #fcf3cf 100%);
            border-radius: 0 10px 10px 0;
        }
        
        .exercise-gold {
            background: linear-gradient(135deg, #fff9c4 0%, #f7dc6f 100%);
            border-left-color: #f1c40f;
        }
        
        button {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            margin: 8px;
            font-size: 15px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(243, 156, 18, 0.3);
        }
        
        button:hover {
            background: linear-gradient(45deg, #e67e22, #d35400);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(243, 156, 18, 0.4);
        }
        
        .special-btn {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }
        
        .special-btn:hover {
            background: linear-gradient(45deg, #c0392b, #a93226);
        }
        
        .output {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            margin: 15px 0;
            min-height: 120px;
            max-height: 500px;
            overflow-y: auto;
            border: 2px solid #34495e;
        }
        
        .output-gold {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            border: 2px solid #f39c12;
        }
        
        .instructions {
            background: linear-gradient(135deg, #ebf3fd 0%, #dbeafe 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #3498db;
        }
        
        .gold-note {
            background: linear-gradient(135deg, #fff9c4 0%, #f7dc6f 100%);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #f1c40f;
            margin: 15px 0;
        }
        
        .promise-info {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border: 2px dashed #6c757d;
        }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-running { background-color: #f39c12; animation: pulse 1.5s infinite; }
        .status-success { background-color: #27ae60; }
        .status-error { background-color: #e74c3c; }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .code-preview {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            margin: 10px 0;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèÜ XP Gold Exercises</h1>
            <div class="gold-badge">Promise.all() Mastery</div>
            <p><strong>Week #5 - Day #1 - Advanced Asynchronous Javascript</strong></p>
        </div>

        <div class="gold-note">
            <strong>üèÜ XP Gold Focus:</strong> Master Promise.all() for concurrent promise execution. 
            These exercises demonstrate advanced concepts in parallel promise handling, timing analysis, and error management.
        </div>

        <!-- Exercise 1 -->
        <div class="exercise-section exercise-gold">
            <h2>üåü Exercise 1: Promise.all() Implementation</h2>
            <div class="instructions">
                <strong>Objective:</strong> Use Promise.all() with 3 different promises and explain the behavior
                <br><br>
                <strong>Promises to handle:</strong>
                <div class="code-preview">const promise1 = Promise.resolve(3);
const promise2 = 42;  // Non-promise value
const promise3 = new Promise((resolve) => {
  setTimeout(resolve, 3000, 'foo');
});</div>
                <strong>Expected Output:</strong> Array [3, 42, "foo"]
            </div>
            
            <div class="promise-info">
                <h4>üìö Promise.all() Behavior:</h4>
                <ul>
                    <li><strong>Concurrent Execution:</strong> All promises run simultaneously</li>
                    <li><strong>Order Preservation:</strong> Results maintain input array order</li>
                    <li><strong>Fail-Fast:</strong> Any rejection rejects entire Promise.all()</li>
                    <li><strong>Wait for All:</strong> Resolves only when ALL promises complete</li>
                </ul>
            </div>
            
            <button onclick="runExercise1()">‚ñ∂Ô∏è Run Exercise 1 (Wait 3s)</button>
            <div id="output1" class="output output-gold"></div>
        </div>

        <!-- Exercise 2 -->
        <div class="exercise-section exercise-gold">
            <h2>üåü Exercise 2: Analyze Promise.all()</h2>
            <div class="instructions">
                <strong>Objective:</strong> Predict and analyze the output of the given code
                <div class="code-preview">function timesTwoAsync(x) {
  return new Promise(resolve => resolve(x * 2));
}

const arr = [1, 2, 3];
const promiseArr = arr.map(timesTwoAsync);

Promise.all(promiseArr)
  .then(result => console.log(result));</div>
            </div>
            
            <button onclick="runExercise2()">üîç Analyze & Run Exercise 2</button>
            <div id="output2" class="output output-gold"></div>
        </div>

        <!-- Additional Examples -->
        <div class="exercise-section">
            <h2>üéØ Advanced Examples</h2>
            <div class="instructions">
                <strong>Bonus:</strong> Explore error handling, timing scenarios, and mixed data types
            </div>
            
            <button onclick="runRejectionExample()">‚ùå Test Rejection Handling</button>
            <button onclick="runTimingExample()">‚è±Ô∏è Test Different Timings</button>
            <button onclick="runMixedTypesExample()">üîÑ Test Mixed Data Types</button>
            <div id="outputAdvanced" class="output"></div>
        </div>

        <!-- Controls -->
        <div class="exercise-section">
            <h2>üéõÔ∏è Control Panel</h2>
            <button onclick="runAllExercises()" class="special-btn">üöÄ Run All Exercises</button>
            <button onclick="clearAllOutputs()" class="special-btn">üßπ Clear All Outputs</button>
            <button onclick="showSummary()" class="special-btn">üìä Show Summary</button>
        </div>
    </div>

    <script>
        // Utility Functions
        function appendOutput(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            const timestamp = new Date().toLocaleTimeString();
            
            let icon = '';
            let color = '#ecf0f1';
            
            switch(type) {
                case 'success': icon = '‚úÖ'; color = '#2ecc71'; break;
                case 'error': icon = '‚ùå'; color = '#e74c3c'; break;
                case 'warning': icon = '‚ö†Ô∏è'; color = '#f39c12'; break;
                case 'info': icon = '‚ÑπÔ∏è'; color = '#3498db'; break;
                default: icon = '‚Ä¢'; break;
            }
            
            element.innerHTML += `<div style="color: ${color}; margin: 5px 0;">
                <span class="status-indicator status-${type === 'success' ? 'success' : type === 'error' ? 'error' : 'running'}"></span>
                ${icon} [${timestamp}] ${message}
            </div>`;
            element.scrollTop = element.scrollHeight;
        }

        // Exercise 1: Promise.all() Implementation
        function runExercise1() {
            const outputId = 'output1';
            document.getElementById(outputId).innerHTML = '';
            
            appendOutput(outputId, 'üèÜ Starting Exercise 1: Promise.all() Implementation', 'info');
            
            // Given promises (exactly as specified)
            const promise1 = Promise.resolve(3);
            const promise2 = 42;
            const promise3 = new Promise((resolve, reject) => {
                setTimeout(resolve, 3000, 'foo');
            });
            
            appendOutput(outputId, 'Created 3 promises:', 'info');
            appendOutput(outputId, '  ‚Ä¢ promise1: Promise.resolve(3) - resolves immediately', 'info');
            appendOutput(outputId, '  ‚Ä¢ promise2: 42 - non-promise value (auto-resolved)', 'info');
            appendOutput(outputId, '  ‚Ä¢ promise3: resolves to "foo" after 3 seconds', 'info');
            appendOutput(outputId, '', 'info');
            appendOutput(outputId, '‚è≥ Running Promise.all() - waiting for all promises...', 'warning');
            appendOutput(outputId, `Start time: ${new Date().toLocaleTimeString()}`, 'info');
            
            const startTime = Date.now();
            
            Promise.all([promise1, promise2, promise3])
                .then(result => {
                    const endTime = Date.now();
                    const duration = Math.round((endTime - startTime) / 1000);
                    
                    appendOutput(outputId, `End time: ${new Date().toLocaleTimeString()}`, 'info');
                    appendOutput(outputId, `Duration: ~${duration} seconds`, 'info');
                    appendOutput(outputId, '', 'info');
                    appendOutput(outputId, `‚úÖ Promise.all() resolved successfully!`, 'success');
                    appendOutput(outputId, `üìä Result: [${result.join(', ')}]`, 'success');
                    appendOutput(outputId, '', 'info');
                    appendOutput(outputId, 'üîç Analysis:', 'info');
                    appendOutput(outputId, `  ‚Ä¢ Array length: ${result.length}`, 'info');
                    appendOutput(outputId, `  ‚Ä¢ Values: ${JSON.stringify(result)}`, 'info');
                    appendOutput(outputId, `  ‚Ä¢ Order preserved: ${result[0] === 3 && result[1] === 42 && result[2] === 'foo'}`, 'info');
                    appendOutput(outputId, `  ‚Ä¢ Total wait time: ~${duration}s (limited by slowest promise)`, 'info');
                })
                .catch(error => {
                    appendOutput(outputId, `‚ùå Promise.all() rejected: ${error}`, 'error');
                });
        }

        // Exercise 2: Analyze Promise.all()
        function runExercise2() {
            const outputId = 'output2';
            document.getElementById(outputId).innerHTML = '';
            
            appendOutput(outputId, 'üîç Starting Exercise 2: Code Analysis', 'info');
            
            function timesTwoAsync(x) {
                return new Promise(resolve => resolve(x * 2));
            }
            
            const arr = [1, 2, 3];
            appendOutput(outputId, `Original array: [${arr.join(', ')}]`, 'info');
            
            const promiseArr = arr.map(timesTwoAsync);
            appendOutput(outputId, 'After mapping through timesTwoAsync:', 'info');
            appendOutput(outputId, `  ‚Ä¢ Created ${promiseArr.length} promises`, 'info');
            appendOutput(outputId, '  ‚Ä¢ Each promise resolves to: input √ó 2', 'info');
            appendOutput(outputId, '', 'info');
            
            appendOutput(outputId, 'üîÆ Prediction:', 'warning');
            appendOutput(outputId, '  ‚Ä¢ 1 √ó 2 = 2', 'warning');
            appendOutput(outputId, '  ‚Ä¢ 2 √ó 2 = 4', 'warning');
            appendOutput(outputId, '  ‚Ä¢ 3 √ó 2 = 6', 'warning');
            appendOutput(outputId, '  ‚Ä¢ Expected result: [2, 4, 6]', 'warning');
            appendOutput(outputId, '', 'info');
            
            appendOutput(outputId, '‚ö° Running Promise.all()...', 'info');
            
            Promise.all(promiseArr)
                .then(result => {
                    appendOutput(outputId, `‚úÖ Actual result: [${result.join(', ')}]`, 'success');
                    appendOutput(outputId, '', 'info');
                    appendOutput(outputId, 'üéØ Analysis Verification:', 'success');
                    appendOutput(outputId, `  ‚Ä¢ Prediction correct: ${JSON.stringify(result) === '[2,4,6]'}`, 'success');
                    appendOutput(outputId, '  ‚Ä¢ All promises resolved immediately (no setTimeout)', 'success');
                    appendOutput(outputId, '  ‚Ä¢ Order maintained from original array', 'success');
                    appendOutput(outputId, '  ‚Ä¢ Execution time: < 1ms (synchronous resolution)', 'success');
                });
        }

        // Advanced Examples
        function runRejectionExample() {
            const outputId = 'outputAdvanced';
            appendOutput(outputId, '', 'info');
            appendOutput(outputId, 'üß™ Testing Promise.all() Rejection Handling:', 'warning');
            
            const successPromise = Promise.resolve("Success!");
            const failurePromise = Promise.reject("Error occurred!");
            const anotherPromise = Promise.resolve("Another success!");
            
            Promise.all([successPromise, failurePromise, anotherPromise])
                .then(results => {
                    appendOutput(outputId, "This shouldn't run", 'info');
                })
                .catch(error => {
                    appendOutput(outputId, `‚ùå Promise.all() rejected: "${error}"`, 'error');
                    appendOutput(outputId, 'üìù Key insight: One rejection fails the entire Promise.all()', 'error');
                });
        }

        function runTimingExample() {
            const outputId = 'outputAdvanced';
            appendOutput(outputId, '', 'info');
            appendOutput(outputId, '‚è±Ô∏è Testing Different Promise Timings:', 'warning');
            
            const fast = new Promise(resolve => setTimeout(resolve, 1000, "Fast (1s)"));
            const medium = new Promise(resolve => setTimeout(resolve, 2000, "Medium (2s)"));
            const slow = new Promise(resolve => setTimeout(resolve, 3000, "Slow (3s)"));
            
            appendOutput(outputId, 'Starting 3 promises with different delays...', 'info');
            const startTime = Date.now();
            
            Promise.all([fast, medium, slow])
                .then(results => {
                    const endTime = Date.now();
                    const duration = Math.round((endTime - startTime) / 1000);
                    appendOutput(outputId, `‚úÖ All completed: [${results.join(', ')}]`, 'success');
                    appendOutput(outputId, `‚è±Ô∏è Total duration: ~${duration}s (limited by slowest: 3s)`, 'success');
                });
        }

        function runMixedTypesExample() {
            const outputId = 'outputAdvanced';
            appendOutput(outputId, '', 'info');
            appendOutput(outputId, 'üîÑ Testing Mixed Data Types:', 'warning');
            
            const mixedArray = [
                Promise.resolve("String promise"),
                42,
                Promise.resolve([1, 2, 3]),
                Promise.resolve({name: "Object"}),
                true,
                Promise.resolve(null)
            ];
            
            Promise.all(mixedArray)
                .then(results => {
                    appendOutput(outputId, '‚úÖ Mixed types handled successfully:', 'success');
                    results.forEach((result, index) => {
                        appendOutput(outputId, `  ‚Ä¢ [${index}]: ${JSON.stringify(result)} (${typeof result})`, 'success');
                    });
                });
        }

        // Control Functions
        function runAllExercises() {
            clearAllOutputs();
            appendOutput('output1', 'üöÄ Running all XP Gold exercises...', 'warning');
            runExercise1();
            setTimeout(() => runExercise2(), 1000);
            setTimeout(() => {
                runRejectionExample();
                runTimingExample();
                runMixedTypesExample();
            }, 2000);
        }

        function clearAllOutputs() {
            ['output1', 'output2', 'outputAdvanced'].forEach(id => {
                document.getElementById(id).innerHTML = '';
            });
        }

        function showSummary() {
            const outputId = 'outputAdvanced';
            document.getElementById(outputId).innerHTML = '';
            appendOutput(outputId, 'üéì XP Gold Summary - Promise.all() Mastery:', 'success');
            appendOutput(outputId, '', 'info');
            appendOutput(outputId, '‚úÖ Key Concepts Mastered:', 'success');
            appendOutput(outputId, '  ‚Ä¢ Concurrent promise execution', 'success');
            appendOutput(outputId, '  ‚Ä¢ Result order preservation', 'success');
            appendOutput(outputId, '  ‚Ä¢ Fail-fast error handling', 'success');
            appendOutput(outputId, '  ‚Ä¢ Mixed data type handling', 'success');
            appendOutput(outputId, '  ‚Ä¢ Timing analysis and optimization', 'success');
            appendOutput(outputId, '', 'info');
            appendOutput(outputId, 'üèÜ XP Gold Status: COMPLETED', 'success');
        }

        // Initialize
        window.onload = function() {
            console.log('üèÜ XP Gold - Promise.all() Exercises Loaded!');
            appendOutput('output1', 'Ready to explore Promise.all() mastery! üöÄ', 'info');
        }
    </script>
</body>
</html>